{
  "comments": [
    {
      "key": {
        "uuid": "b994e2f8_8f2d54e1",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1026112
      },
      "writtenOn": "2017-11-24T10:40:43Z",
      "side": 1,
      "message": "I don\u0027t see any previous reads from the GroupCache? Also I don\u0027t think a project can be read from the GroupCache.",
      "range": {
        "startLine": 7,
        "startChar": 45,
        "endLine": 7,
        "endChar": 56
      },
      "revId": "c61210b15ffd994d9ee3de9e6dbbbaa94cb7c1af",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9c18b2a9_450b5bec",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1011842
      },
      "writtenOn": "2017-11-24T10:44:34Z",
      "side": 1,
      "message": "I think this intends project cache: https://gerrit.googlesource.com/gerrit/+/2eab4bdb436b63aa8b6f8f83dbaedd955e8b8f81/java/com/google/gerrit/server/config/PluginConfigFactory.java#130",
      "parentUuid": "b994e2f8_8f2d54e1",
      "range": {
        "startLine": 7,
        "startChar": 45,
        "endLine": 7,
        "endChar": 56
      },
      "revId": "c61210b15ffd994d9ee3de9e6dbbbaa94cb7c1af",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cf65b5e5_e63ef359",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1036808
      },
      "writtenOn": "2017-11-28T20:14:25Z",
      "side": 1,
      "message": "+1, s/group cache/projectCache/",
      "parentUuid": "9c18b2a9_450b5bec",
      "range": {
        "startLine": 7,
        "startChar": 45,
        "endLine": 7,
        "endChar": 56
      },
      "revId": "c61210b15ffd994d9ee3de9e6dbbbaa94cb7c1af",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "53a41205_a65d5c62",
        "filename": "/COMMIT_MSG",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1031898
      },
      "writtenOn": "2017-11-29T09:07:41Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "cf65b5e5_e63ef359",
      "range": {
        "startLine": 7,
        "startChar": 45,
        "endLine": 7,
        "endChar": 56
      },
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "c61210b15ffd994d9ee3de9e6dbbbaa94cb7c1af",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa7262bb_70125b44",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/findowners/Cache.java",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1036808
      },
      "writtenOn": "2017-11-28T20:14:25Z",
      "side": 1,
      "message": "Now Cache.get functions need a ProjectState.\nThey are called also by FindOwnersIt.java and Action.java.\nCould you change those callers too?\nYou probably also need to inject projectState from GetOwners.java.",
      "range": {
        "startLine": 91,
        "startChar": 11,
        "endLine": 91,
        "endChar": 14
      },
      "revId": "c61210b15ffd994d9ee3de9e6dbbbaa94cb7c1af",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "11c63486_9a80ca2b",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/findowners/Cache.java",
        "patchSetId": 1
      },
      "lineNbr": 91,
      "author": {
        "id": 1031898
      },
      "writtenOn": "2017-11-29T09:07:41Z",
      "side": 1,
      "message": "Yes. There are other places I need to adjust. In the end, I still have to inject ProjectCache in those places. But it might work there. I notice some classes may be able to annotated as @Singleton, e.g. GetOwners, etc.",
      "parentUuid": "fa7262bb_70125b44",
      "range": {
        "startLine": 91,
        "startChar": 11,
        "endLine": 91,
        "endChar": 14
      },
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "c61210b15ffd994d9ee3de9e6dbbbaa94cb7c1af",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d1002bb0_de88a662",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/findowners/Checker.java",
        "patchSetId": 1
      },
      "lineNbr": 108,
      "author": {
        "id": 1036808
      },
      "writtenOn": "2017-11-28T20:14:25Z",
      "side": 1,
      "message": "Do we expect non-null projectState here, even when the project is missing in projectCache?\nCould you add a check here? Something like:\n  if (projectState \u003d\u003d null) {\n    log.error(\"Project state not found for \" + Config.getChangeId(changeData));\n    return 0;\n  }",
      "range": {
        "startLine": 108,
        "startChar": 19,
        "endLine": 108,
        "endChar": 31
      },
      "revId": "c61210b15ffd994d9ee3de9e6dbbbaa94cb7c1af",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "648d835a_a3db4f82",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/findowners/Checker.java",
        "patchSetId": 1
      },
      "lineNbr": 108,
      "author": {
        "id": 1031898
      },
      "writtenOn": "2017-11-29T09:07:41Z",
      "side": 1,
      "message": "I would expect this should never be null. I have added a check in SubmitRuleEvaluator before the value is stored.\nhttps://gerrit-review.googlesource.com/c/gerrit/+/144192",
      "parentUuid": "d1002bb0_de88a662",
      "range": {
        "startLine": 108,
        "startChar": 19,
        "endLine": 108,
        "endChar": 31
      },
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "c61210b15ffd994d9ee3de9e6dbbbaa94cb7c1af",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c2a2a4af_d105a59d",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/findowners/Checker.java",
        "patchSetId": 1
      },
      "lineNbr": 108,
      "author": {
        "id": 1036808
      },
      "writtenOn": "2017-11-29T18:46:05Z",
      "side": 1,
      "message": "c/144192 is exactly what I wished to have.  Could we have that change pushed to Gerrit servers before making any more change to find-owners plugin?\n\nAfter c/144192, if we see only NoSuchProjectException from SubmitRuleEvaluator and not from find-owners plugin, then we know that problem is in the set up of projectCache in/before SubmitRuleEvaluator, and using projectState in find-owners here won\u0027t help. We need to find out what CLs and APIs triggered those SubmitRuleEvaluator without project state in the projectCache.\n\nIf we see only \"Cannot find project\" in find-owners but not NoSuchProjectException after c/144192, then we know that projectCache is fine in SubmitRuleEvaluator, but not in getFromProjectConfigWithInheritance. We should fix getFromProjectConfigWithInheritance.",
      "parentUuid": "648d835a_a3db4f82",
      "range": {
        "startLine": 108,
        "startChar": 19,
        "endLine": 108,
        "endChar": 31
      },
      "revId": "c61210b15ffd994d9ee3de9e6dbbbaa94cb7c1af",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e1806f88_7b2e8b73",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/findowners/Checker.java",
        "patchSetId": 1
      },
      "lineNbr": 108,
      "author": {
        "id": 1031898
      },
      "writtenOn": "2017-11-30T08:28:46Z",
      "side": 1,
      "message": "That change is living in our prod. And I have checked the logs, they are exactly the same. \n\nIn fact, the projectState in SubmitRuleEvaluator will not be null. Or we will see NPE in #getPrologEnvironment. \n\n\u003e If we see only \"Cannot find project\" in find-owners but not NoSuchProjectException after c/144192, then we know that projectCache is fine in SubmitRuleEvaluator, but not in getFromProjectConfigWithInheritance. We should fix getFromProjectConfigWithInheritance.\n\nI\u0027m not pretty sure the cause. Let\u0027s see if using projectCache directly in this plugin like this change will make a difference.",
      "parentUuid": "c2a2a4af_d105a59d",
      "range": {
        "startLine": 108,
        "startChar": 19,
        "endLine": 108,
        "endChar": 31
      },
      "revId": "c61210b15ffd994d9ee3de9e6dbbbaa94cb7c1af",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dcb874d7_a9cb296b",
        "filename": "src/main/java/com/googlesource/gerrit/plugins/findowners/Config.java",
        "patchSetId": 1
      },
      "lineNbr": 99,
      "author": {
        "id": 1031898
      },
      "writtenOn": "2017-11-24T10:42:40Z",
      "side": 1,
      "message": "Here it tries to read from group cache and it gets null for project state there.",
      "range": {
        "startLine": 99,
        "startChar": 15,
        "endLine": 99,
        "endChar": 63
      },
      "revId": "c61210b15ffd994d9ee3de9e6dbbbaa94cb7c1af",
      "serverId": "173816e5-2b9a-37c3-8a2e-48639d4f1153",
      "unresolved": false
    }
  ]
}